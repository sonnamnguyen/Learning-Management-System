<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined">
    <link rel="stylesheet" type='text/css' href="https://cdn.jsdelivr.net/gh/devicons/devicon@latest/devicon.min.css" />

</head>
<style>
    .material-symbols-outlined {
        font-variation-settings:
                'FILL' 0,
                'wght' 400,
                'GRAD' 0,
                'opsz' 24
    }

    body {
        background-color: rgb(26, 26, 26);
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
        color: rgb(255, 255, 255);
    }

    .container {
        max-width: 1200px;
        padding: 20px;
    }

    /* User Profile Header */
    .profile-header {
        background: rgb(40, 40, 40);
        border-radius: 8px;
        padding: 24px;
        margin-bottom: 24px;
        display: flex;
        align-items: center;
        gap: 24px;
        position: relative;
        overflow: hidden;
        transition: all 0.5s ease;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
    }

    /* .profile-header::after {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 50%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
        transition: all 0.5s ease;
    }

    .profile-header:hover::after {
        left: 100%;
    } */

    .profile-avatar {
        width: 100px;
        height: 100px;
        border-radius: 50%;
        object-fit: cover;
        border: 3px solid rgb(79, 193, 255);
        transition: all 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55);
        box-shadow: 0 0 15px rgba(79, 193, 255, 0.5);
    }

    .profile-avatar:hover {
        transform: scale(1.05) rotate(5deg);
        box-shadow: 0 0 25px rgba(79, 193, 255, 0.8);
        border-width: 4px;
    }

    .profile-info {
        flex-grow: 1;
    }

    .profile-name {
        font-size: 30px;
        font-weight: 600;
        color: rgb(255, 255, 255);
        margin-bottom: 8px;
        position: relative;
        display: inline-block;
        transition: all 0.3s ease;
    }

    .profile-name:hover {
        text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        letter-spacing: 1px;
    }

    .profile-details {
        display: flex;
        gap: 24px;
        color: rgb(156, 156, 156);
        font-size: 14px;
    }

    .profile-detail-item {
        display: flex;
        align-items: center;
        gap: 8px;
        transition: all 0.3s ease;
        padding: 5px 10px;
        border-radius: 8px;
    }

    .profile-detail-item:hover {
        background: rgba(255, 255, 255, 0.1);
        transform: translateX(5px);
        box-shadow: -5px 0 10px rgba(0, 0, 0, 0.2);
    }

    .profile-detail-item i {
        font-size: 16px;
        margin-right: 8px;
    }

    .edit-profile-btn {
        background: transparent;
        border: 1px solid rgb(79, 193, 255);
        color: rgb(79, 193, 255);
        padding: 8px 16px;
        border-radius: 4px;
        cursor: pointer;
        transition: all 0.2s;
    }

    .edit-profile-btn:hover {
        background: rgba(79, 193, 255, 0.1);
    }

    /* Stats Card */
    .stats-card {
        background: rgb(40, 40, 40);
        border-radius: 8px;
        padding: 24px;
        margin-bottom: 24px;
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 20px;
        perspective: 1000px;
    }

    .stat-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 8px;
        padding: 20px 15px;
        border-radius: 12px;
        transition: all 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55);
        /* background: linear-gradient(145deg, rgba(48, 48, 48, 0.8), rgba(38, 38, 38, 0.8));
        box-shadow: 5px 5px 10px rgba(0, 0, 0, 0.2),
            -5px -5px 10px rgba(255, 255, 255, 0.05); */
        transform-style: preserve-3d;
        position: relative;
        overflow: hidden;
    }

    .stat-item::before {
        content: '';
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        opacity: 0;
        transition: opacity 0.5s ease;
        pointer-events: none;
    }

    /* .stat-item:hover {
        transform: translateY(-10px) rotateX(10deg);
        box-shadow: 0 15px 25px rgba(0, 0, 0, 0.3);
    } */

    .stat-item:hover::before {
        opacity: 1;
    }

    .stat-item:hover .stat-icon {
        transform: translateY(-5px) scale(1.2);
    }

    .stat-number {
        font-size: 28px;
        font-weight: 700;
        background: linear-gradient(90deg, #4FC1FF, #4CAF50);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        transition: all 0.3s ease;
    }

    .stat-item:hover .stat-number {
        letter-spacing: 1px;
    }

    .stat-label {
        color: rgb(156, 156, 156);
        font-size: 14px;
        margin-top: 4px;
    }

    /* Progress Charts */
    .charts-container {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 24px;
        margin-bottom: 24px;
        min-height: 400px;
    }

    .chart-card {
        background: rgb(40, 40, 40);
        border-radius: 8px;
        padding: 24px;
        min-height: 380px;
    }

    .chart-title {
        color: rgb(255, 255, 255);
        font-size: 16px;
        font-weight: 500;
        margin-bottom: 16px;
        padding-bottom: 12px;
    }

    /* Submission History */
    .history-card {
        background: rgb(40, 40, 40);
        border-radius: 8px;
        padding: 20px;
    }

    .history-title {
        color: rgb(255, 255, 255);
        font-size: 16px;
        font-weight: 500;
        margin-bottom: 16px;
        padding-bottom: 12px;
        border-bottom: 1px solid rgb(61, 61, 61);
    }

    .submission-list {
        list-style: none;
        padding: 0;
        margin: 0;
    }

    .submission-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 16px;
        border-radius: 4px;
        margin-bottom: 8px;
        background: rgb(48, 48, 48);
        transition: background-color 0.2s;
    }

    .submission-item:hover {
        background: rgb(55, 55, 55);
    }

    .problem-name {
        color: rgb(79, 193, 255);
        text-decoration: none;
    }

    .submission-status {
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .status-accepted {
        color: rgb(67, 160, 71);
    }

    .status-wrong {
        color: rgb(239, 71, 67);
    }

    .submission-time {
        color: rgb(156, 156, 156);
        font-size: 14px;
    }

    /* Difficulty Tags */
    .difficulty-easy {
        color: rgb(67, 160, 71);
    }

    .difficulty-medium {
        color: rgb(255, 192, 30);
    }

    .difficulty-hard {
        color: rgb(239, 71, 67);
    }

    /* Charts Customization */
    canvas {
        width: 100% !important;
        height: 300px !important;
    }

    /* Responsive Design */
    @media (max-width: 768px) {
        .stats-card {
            grid-template-columns: 1fr;
        }

        .charts-container {
            grid-template-columns: 1fr;
        }

        .chart-card {
            min-height: 350px;
        }
    }

    /* Achievements Card */
    .achievements-card {
        background: rgb(40, 40, 40);
        border-radius: 8px;
        padding: 24px;
        margin-bottom: 24px;
    }

    .achievements-title {
        color: rgb(255, 255, 255);
        font-size: 16px;
        font-weight: 500;
        margin-bottom: 0;
        padding-bottom: 0;
    }

    .achievements-container {
        overflow-x: auto;
        padding: 10px 0;
        margin: 0 -20px;
        scrollbar-width: thin;
        scrollbar-color: rgba(255, 255, 255, 0.2) transparent;
    }

    /* Custom scrollbar cho Webkit browsers */
    .achievements-container::-webkit-scrollbar {
        height: 6px;
    }

    .achievements-container::-webkit-scrollbar-track {
        background: transparent;
    }

    .achievements-container::-webkit-scrollbar-thumb {
        background-color: rgba(255, 255, 255, 0.2);
        border-radius: 6px;
    }

    .achievements-container::-webkit-scrollbar-thumb:hover {
        background-color: rgba(255, 255, 255, 0.3);
    }

    .achievements-grid {
        display: grid;
        grid-auto-flow: column;
        grid-auto-columns: 280px;
        gap: 20px;
        padding: 10px 20px;
    }

    .achievement-item {
        background: rgba(48, 48, 48, 0.8);
        border-radius: 12px;
        padding: 20px;
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: center;
        transition: all 0.3s ease;
        border: 1px solid rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        min-width: 280px;
    }

    .achievement-item:hover {
        transform: translateY(-5px);
        background: rgba(55, 55, 55, 0.9);
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
    }

    .achievement-icon {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        background: linear-gradient(145deg, #2a2a2a, #383838);
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 15px;
        font-size: 24px;
        color: #666;
        transition: all 0.3s ease;
        box-shadow: 5px 5px 10px rgba(0, 0, 0, 0.2),
        -5px -5px 10px rgba(255, 255, 255, 0.05);
    }

    .achievement-icon.unlocked {
        background: linear-gradient(145deg, #4CAF50, #2196F3);
        color: white;
        box-shadow: 0 0 20px rgba(76, 175, 80, 0.3);
        animation: rotate360 3s infinite linear;
    }

    @keyframes rotate360 {
        from {
            transform: rotate(0deg);
        }

        to {
            transform: rotate(360deg);
        }
    }

    .achievement-name {
        color: #fff;
        font-size: 16px;
        font-weight: 600;
        margin-bottom: 8px;
    }

    .achievement-progress {
        color: #888;
        font-size: 14px;
        font-weight: 500;
        background: rgba(0, 0, 0, 0.2);
        padding: 4px 12px;
        border-radius: 12px;
        min-width: 60px;
    }

    /* Custom tooltip style */
    .achievement-tooltip {
        background-color: rgba(40, 40, 40, 0.95) !important;
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        padding: 8px 12px;
        border-radius: 8px;
        font-size: 14px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    @media (max-width: 768px) {
        .achievements-grid {
            grid-auto-columns: 240px;
        }

        .achievement-item {
            min-width: 240px;
            padding: 15px;
        }
    }

    /* New styles for chart-card */
    .chart-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 16px;
        border-bottom: 1px solid rgb(61, 61, 61);
    }

    .language-select {
        background: rgba(48, 48, 48, 0.8);
        border: 1px solid rgba(255, 255, 255, 0.1);
        color: #fff;
        padding: 6px 12px;
        border-radius: 6px;
        cursor: pointer;
        outline: none;
        font-size: 14px;
        margin-bottom: 20px;
    }

    .language-select:hover {
        background: rgba(55, 55, 55, 0.9);
    }

    .language-select option {
        background: #2a2a2a;
        color: #fff;
    }

    /* AI Recommendations Styles */
    .ai-recommendations {
        padding: 15px 0;
    }

    .recommendation-item {
        background: rgba(48, 48, 48, 0.8);
        border-radius: 8px;
        padding: 15px;
        margin-bottom: 12px;
        border-left: 4px solid #4CAF50;
        transition: all 0.2s ease;
    }

    .recommendation-item:hover {
        background: rgba(55, 55, 55, 0.9);

    }

    .recommendation-item.medium {
        border-left-color: #FFC01E;
    }

    .recommendation-item.hard {
        border-left-color: #EF4743;
    }

    .recommendation-title {
        font-weight: 600;
        margin-bottom: 8px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .recommendation-tag {
        font-size: 12px;
        padding: 3px 8px;
        border-radius: 12px;
        background: rgba(76, 175, 80, 0.2);
        color: #4CAF50;
    }

    .recommendation-tag.medium {
        background: rgba(255, 192, 30, 0.2);
        color: #FFC01E;
    }

    .recommendation-tag.hard {
        background: rgba(239, 71, 67, 0.2);
        color: #EF4743;
    }

    .recommendation-description {
        color: #CCC;
        font-size: 14px;
        margin-bottom: 10px;
    }

    .recommendation-reason {
        font-size: 13px;
        color: #999;
        font-style: italic;
    }

    .refresh-btn {
        background: transparent;
        border: none;
        color: #4CAF50;
        cursor: pointer;
        font-size: 16px;
        transition: transform 0.3s ease;
    }

    .refresh-btn:hover {
        transform: rotate(180deg);
    }

    .loading-spinner {
        text-align: center;
        padding: 20px;
        color: #999;
    }

    .header-controls {
        display: flex;
        align-items: center;
    }

    .prompt-language-select {
        background: rgba(48, 48, 48, 0.8);
        border: 1px solid rgba(255, 255, 255, 0.1);
        color: #fff;
        padding: 6px 12px;
        border-radius: 6px;
        cursor: pointer;
        outline: none;
        font-size: 14px;
    }

    .prompt-language-select:hover {
        background: rgba(55, 55, 55, 0.9);
    }

    .prompt-language-select option {
        background: #2a2a2a;
        color: #fff;
    }

    /* Cập nhật style cho Recent Submissions */
    .recent-submissions {
        background: linear-gradient(145deg, #2d2d2d, #363636);
        border-radius: 12px;
        padding: 24px;
        margin-top: 20px;
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
        border: 1px solid rgba(255, 255, 255, 0.05);
        position: relative;
        overflow: hidden;
    }

    .recent-submissions::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 2px;
        background: linear-gradient(90deg, #4FC1FF, #4CAF50);
        animation: shimmer 2s infinite linear;
    }

    @keyframes shimmer {
        0% {
            background-position: -200% 0;
        }

        100% {
            background-position: 200% 0;
        }
    }

    .recent-submissions-title {
        color: #ffffff;
        font-size: 22px;
        margin-bottom: 24px;
        font-weight: 600;
        text-shadow: 0 0 10px rgba(255, 255, 255, 0.2);
    }

    .submission-item {
        background: linear-gradient(145deg, #363636, #404040);
        border-radius: 8px;
        padding: 16px;
        margin-bottom: 12px;
        transition: all 0.3s ease;
        border: 1px solid rgba(255, 255, 255, 0.05);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    .submission-item:hover {
        transform: translateY(-2px);
        background: linear-gradient(145deg, #404040, #484848);
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2);
        border-color: rgba(79, 193, 255, 0.3);
    }

    .submission-title {
        color: #e1e6eb;
        font-size: 16px;
        font-weight: 500;
        transition: all 0.3s ease;
    }

    .submission-item:hover .submission-title {
        color: #4FC1FF;
        text-shadow: 0 0 8px rgba(79, 193, 255, 0.3);
    }

    .submission-meta {
        display: flex;
        align-items: center;
        gap: 15px;
        color: #999;
        font-size: 14px;
    }

    /* Cập nhật style cho pagination */
    .pagination {
        background: linear-gradient(145deg, #2d2d2d, #363636);
        border-radius: 20px;
        padding: 8px 16px;
        gap: 8px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }

    .page-btn {
        background: transparent;
        border: 1px solid rgba(79, 193, 255, 0.2);
        color: #fff;
        padding: 8px 16px;
        border-radius: 6px;
        transition: all 0.3s ease;
        min-width: 40px;
        height: 40px;
    }

    .page-btn:hover:not(:disabled) {
        background: rgba(79, 193, 255, 0.1);
        border-color: rgba(79, 193, 255, 0.4);
        transform: translateY(-2px);
    }

    .page-btn.active {
        background: linear-gradient(145deg, #4CAF50, #45a049);
        border-color: transparent;
        box-shadow: 0 0 10px rgba(76, 175, 80, 0.3);
    }

    .page-btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        border-color: rgba(255, 255, 255, 0.1);
    }

    /* Hiệu ứng cho submissions list khi chuyển trang */
    .submissions-list {
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    /* Animation cho loading state */
    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(20px);
        }

        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .submission-item {
        animation: fadeInUp 0.3s ease forwards;
        animation-delay: calc(var(--item-index) * 0.1s);
    }

    /* Thêm vào phần style hiện có */

    /* Icon styles */
    .verified-badge {
        color: #4CAF50;
        font-size: 16px;
        margin-left: 8px;
        animation: sparkle 3s infinite;
        text-shadow: 0 0 5px rgba(76, 175, 80, 0.7);
    }

    @keyframes sparkle {

        0%,
        100% {
            transform: scale(1);
            opacity: 1;
            filter: brightness(1);
        }

        50% {
            transform: scale(1.2);
            opacity: 0.9;
            filter: brightness(1.5);
        }

        25%,
        75% {
            transform: scale(1.1);
            opacity: 0.8;
            filter: brightness(1.2);
        }
    }

    .location-icon {
        color: #FF6B6B;
        animation: bounce 2s ease infinite;
    }

    @keyframes bounce {

        0%,
        20%,
        50%,
        80%,
        100% {
            transform: translateY(0);
        }

        40% {
            transform: translateY(-5px);
        }

        60% {
            transform: translateY(-3px);
        }
    }

    .calendar-icon {
        color: #4FC1FF;
        animation: flip 4s infinite;
        transform-style: preserve-3d;
    }

    @keyframes flip {

        0%,
        100% {
            transform: rotateY(0deg);
        }

        50% {
            transform: rotateY(180deg);
        }
    }

    .code-icon {
        color: #FFD700;
        position: relative;
        animation: typing 3s steps(5) infinite;
    }

    @keyframes typing {
        0% {
            transform: scale(1);
        }

        20% {
            transform: scale(0.9);
        }

        40% {
            transform: scale(1.1);
        }

        60% {
            transform: scale(0.9);
        }

        80% {
            transform: scale(1.1);
        }

        100% {
            transform: scale(1);
        }
    }

    .stat-icon {
        font-size: 28px;
        margin-bottom: 15px;
        filter: drop-shadow(0 0 8px currentColor);
        transition: all 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55);
    }

    /* Custom colors và hiệu ứng cho từng stat */
    .stat-item:nth-child(1) .stat-icon {
        color: #4CAF50;
        animation: pulse-green 3s infinite;
    }

    .stat-item:nth-child(2) .stat-icon {
        color: #FF6B6B;
        animation: pulse-red 3s infinite;
    }

    .stat-item:nth-child(3) .stat-icon {
        color: #FFD700;
        animation: pulse-gold 3s infinite;
    }

    @keyframes pulse-green {

        0%,
        100% {
            filter: drop-shadow(0 0 5px rgba(76, 175, 80, 0.7));
        }

        50% {
            filter: drop-shadow(0 0 15px rgba(76, 175, 80, 0.9));
        }
    }

    @keyframes pulse-red {

        0%,
        100% {
            filter: drop-shadow(0 0 5px rgba(255, 107, 107, 0.7));
        }

        50% {
            filter: drop-shadow(0 0 15px rgba(255, 107, 107, 0.9));
        }
    }

    @keyframes pulse-gold {

        0%,
        100% {
            filter: drop-shadow(0 0 5px rgba(255, 215, 0, 0.7));
        }

        50% {
            filter: drop-shadow(0 0 15px rgba(255, 215, 0, 0.9));
        }
    }

    /* Hiệu ứng hover cho profile details */
    .profile-detail-item {
        transition: all 0.3s ease;
        padding: 5px 10px;
        border-radius: 8px;
    }

    .profile-detail-item:hover {
        background: rgba(255, 255, 255, 0.1);
        transform: translateX(5px);
        box-shadow: -5px 0 10px rgba(0, 0, 0, 0.2);
    }

    /* Hiệu ứng 3D cho stat cards */
    .stats-card {
        perspective: 1000px;
    }

    .stat-item {
        padding: 20px 15px;
        border-radius: 12px;
        transition: all 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55);
        /* background: linear-gradient(145deg, rgba(48, 48, 48, 0.8), rgba(38, 38, 38, 0.8));
        box-shadow: 5px 5px 10px rgba(0, 0, 0, 0.2),
            -5px -5px 10px rgba(255, 255, 255, 0.05); */
        transform-style: preserve-3d;
        position: relative;
        overflow: hidden;
    }

    /* .stat-item::before {
        content: '';
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, transparent 70%);
        opacity: 0;
        transition: opacity 0.5s ease;
        pointer-events: none;
    } */

    /* .stat-item:hover {
        transform: translateY(-10px) rotateX(10deg);
        box-shadow: 0 15px 25px rgba(0, 0, 0, 0.3);
    } */
    /*
    .stat-item:hover::before {
        opacity: 1;
    } */

    /* .stat-item:hover .stat-icon {
        transform: translateY(-5px) scale(1.2);
    } */

    .stat-number {
        font-size: 28px;
        font-weight: 700;
        background: linear-gradient(90deg, #4FC1FF, #4CAF50);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        transition: all 0.3s ease;
    }

    .stat-item:hover .stat-number {
        letter-spacing: 1px;
    }

    /* Hiệu ứng cho profile header */
    /* .profile-header {
        position: relative;
        overflow: hidden;
        transition: all 0.5s ease;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
    } */

    /* .profile-header::after {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 50%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
        transition: all 0.5s ease;
    }

    .profile-header:hover::after {
        left: 100%;
    } */

    /* Hiệu ứng cho avatar */
    .profile-avatar {
        transition: all 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55);
        box-shadow: 0 0 15px rgba(79, 193, 255, 0.5);
    }

    .profile-avatar:hover {
        transform: scale(1.05) rotate(5deg);
        box-shadow: 0 0 25px rgba(79, 193, 255, 0.8);
        border-width: 4px;
    }

    /* Hiệu ứng cho profile name */
    .profile-name {
        position: relative;
        display: inline-block;
        transition: all 0.3s ease;
    }

    .profile-name:hover {
        text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        letter-spacing: 1px;
    }

    /* CSS cho hiệu ứng chuyển trang */
    .submissions-list {
        transition: all 0.3s ease;
    }

    .page-btn {
        position: relative;
        overflow: hidden;
    }

    .page-btn::after {
        content: '';
        position: absolute;
        top: 50%;
        left: 50%;
        width: 0;
        height: 0;
        background: rgba(255, 255, 255, 0.2);
        border-radius: 50%;
        transform: translate(-50%, -50%);
        transition: all 0.5s ease;
    }

    .page-btn:active::after {
        width: 120px;
        height: 120px;
        opacity: 0;
    }

    /* Hiệu ứng cho nút active */
    .page-btn.active {
        background: #4CAF50;
        border-color: #4CAF50;
        transform: scale(1.1);
    }
    .achievements-counter {
        background: linear-gradient(90deg, #4FC1FF, #4CAF50);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        font-weight: 500;
        padding: 2px 8px;
        border-radius: 4px;
    }

    .achievements-counter span {
        font-weight: 700;
    }

</style>

<body>

<div class="container">
    <!-- Profile Header -->
    <div class="profile-header">
        <a href="/exercises">
            <img src="data:image/jpeg;base64,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"
                 alt="Profile Avatar" class="profile-avatar">
        </a>
        <div class="profile-info">
            <input type="hidden" id="userId" th:value="${user.id}">
            <h1 class="profile-name" th:text="${user.username}">
                Phụng Sexy
                <i class="fas fa-check-circle verified-badge"></i>
            </h1>
            <div class="profile-details">
                <div class="profile-detail-item">
                    <i class="fas fa-map-marker-alt location-icon"></i>
                    <span>Việt Nam</span>
                </div>
                <div class="profile-detail-item">
                    <i class="fas fa-calendar-alt calendar-icon"></i>
                    <span>Joined Mar 2024</span>
                </div>
                <div class="profile-detail-item">
                    <i class="fas fa-laptop-code code-icon"></i>
                    <span>Java, C++, SQL</span>
                </div>
            </div>
        </div>
        <!-- <button class="edit-profile-btn">Edit Profile</button> -->
    </div>

    <!-- Stats Overview -->
    <div class="stats-card">
        <div class="stat-item">
            <i class="fas fa-check-circle stat-icon"></i>
            <div class="stat-number"></div>
            <div class="stat-label">Problems Solved</div>
        </div>
        <div class="stat-item">
            <i class="fas fa-code-branch stat-icon"></i>
            <div class="stat-number"></div>
            <div class="stat-label">Submissions</div>
        </div>
        <div class="stat-item">
            <i class="fas fa-percentage stat-icon"></i>
            <div class="stat-number"></div>
            <div class="stat-label">Acceptance Rate</div>
        </div>
    </div>

    <!-- Achievements Card -->
    <div class="achievements-card">
        <div style="display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid rgb(61, 61, 61); padding-bottom: 12px;">
            <h3 class="achievements-title">Achievements</h3>
            <div class="achievements-counter" style="font-size: 14px; color: #fff;">
                <span id="completed-achievements">0</span>/<span id="total-achievements">0</span> Completed
            </div>
        </div>
        <div class="achievements-container">
            <div class="achievements-grid">
                <!-- Achievements will be populated here -->
            </div>
        </div>
    </div>

    <!-- Charts Section -->
    <div class="charts-container">
        <div class="chart-card">
            <h3 class="chart-title">Solving Progress</h3>
            <canvas id="progressChart"></canvas>
        </div>
        <div class="chart-card">
            <div class="chart-header">
                <h3 class="chart-title">Problem Types</h3>
                <form id="filterForm" method="get" th:action="@{/exercises/profile/{userId}(userId=${user.id})}">
                    <select id="program-languages" class="language-select" name="language"
                            onchange="this.form.submit()">
                        <option value="" th:selected="${currentLanguage == ''}">Overall</option>
                        <option th:each="lang : ${languages}" th:value="${lang.language}" th:text="${lang.language}"
                                th:selected="${lang.language == currentLanguage}">
                        </option>
                    </select>
                </form>

            </div>
            <canvas id="difficultyChart"></canvas>
        </div>
    </div>

    <!-- AI Learning Recommendations -->
    <div class="chart-card">
        <div class="chart-header">
            <h3 class="chart-title">AI Recommendations</h3>

            <div class="header-controls">
                <select class="prompt-language-select" id="promptLanguage"
                        style="margin-right: 10px ; margin-bottom: 20px;">
                    <option value="en">English</option>
                    <option value="vi">Tiếng Việt</option>
                </select>
                <button class="refresh-btn" style="margin-bottom: 20px; margin-left: 10px;"
                        id="refreshRecommendations">
                    <i class="fas fa-sync-alt"></i>
                </button>
            </div>
        </div>
        <p style="font-size: 14px; color: #6c757d;">The information provided by AI is intended for reference
            purposes and its accuracy is not guaranteed.</p>
        <div id="aiRecommendations" class="ai-recommendations">
            <div style="text-align: center; padding: 20px; color: #6c757d;">
                <i class="fas fa-robot" style="font-size: 24px; margin-bottom: 10px;"></i>
                <p>Click the refresh button to get the analysis from AI</p>
            </div>
        </div>

    </div>
    <div class="" style="margin-top: 20px;">
        <div class="recent-submissions">
            <h3 class="recent-submissions-title">Recent Submissions</h3>
            <div class="submissions-list" id="submissions-list">
                <!-- Dữ liệu sẽ được thêm vào bằng JavaScript -->
            </div>
            <!-- Phân trang -->
            <div class="pagination-container">
                <div class="pagination">
                    <button class="page-btn" id="prev-btn">
                        <i class="fas fa-chevron-left"></i>
                    </button>

                    <div class="page-numbers" id="page-numbers"></div>

                    <button class="page-btn" id="next-btn">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </div>

        </div>
    </div>

</div>

<!-- Modal Chỉnh sửa Hồ sơ -->
<div class="modal fade" id="editProfileModal" tabindex="-1" aria-labelledby="editProfileModalLabel"
     aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content bg-dark text-white">
            <div class="modal-header border-secondary">
                <h5 class="modal-title" id="editProfileModalLabel">Edit Profile</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"
                        aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="mb-3">
                    <label for="editUsername" class="form-label">Name</label>
                    <input type="text" class="form-control bg-dark text-white border-secondary" id="editUsername">
                </div>
                <div class="mb-3">
                    <label for="editLocation" class="form-label">Location</label>
                    <input type="text" class="form-control bg-dark text-white border-secondary" id="editLocation">
                </div>
                <div class="mb-3">
                    <label for="editLanguages" class="form-label">Programming Languages</label>
                    <input type="text" class="form-control bg-dark text-white border-secondary" id="editLanguages">
                </div>
                <div class="mb-3">
                    <label for="editAvatar" class="form-label">Profile Picture</label>
                    <input type="file" class="form-control bg-dark text-white border-secondary" id="editAvatar"
                           accept="image/*">
                </div>
            </div>
            <div class="modal-footer border-secondary">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" id="saveProfile">Save changes</button>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script th:inline="javascript">
    /*<![CDATA[*/
    // Đưa code phân trang ra ngoài document.addEventListener
    const submissionsData = /*[[${studentAttempts}]]*/ [];
    const ITEMS_PER_PAGE = 5;
    let currentPage = 1;

    // Định nghĩa các hàm ở phạm vi toàn cục
    function displaySubmissions(page) {
        const submissionsList = document.getElementById('submissions-list');
        const start = (page - 1) * ITEMS_PER_PAGE;
        const end = start + ITEMS_PER_PAGE;
        const paginatedData = submissionsData.slice(start, end);
        let userId = document.getElementById("userId").value;
        submissionsList.innerHTML = '';

        paginatedData.forEach(submission => {
            submissionsList.innerHTML += `
<div class="submission-item"
     onclick="window.location.href='/judgement/get_exercise?userId=' + document.getElementById('userId').value  + '&exerciseAttemptId=' + this.dataset.id"
     data-id="${submission.id}">
                        <div class="submission-title">${submission.name}</div>
                        <div class="submission-meta">
                            <span class="submission-time">${submission.time}</span>
                        </div>
                    </div>
                `;
        });
    }

    function updatePagination() {
        const totalPages = Math.ceil(submissionsData.length / ITEMS_PER_PAGE);
        const pageNumbers = document.getElementById('page-numbers');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');


        // Vô hiệu hóa các nút khi cần thiết
        prevBtn.disabled = currentPage === 1;
        nextBtn.disabled = currentPage === totalPages;

        // Xử lý sự kiện click
        prevBtn.onclick = () => goToPage(currentPage - 1);
        nextBtn.onclick = () => goToPage(currentPage + 1);


        pageNumbers.innerHTML = '';

        let pagesToShow = [];
        if (totalPages <= 5) {
            // Hiển thị tất cả nếu có ít trang
            pagesToShow = Array.from({ length: totalPages }, (_, i) => i + 1);
        } else {
            if (currentPage < 3) {
                pagesToShow = [1, 2, 3, '...', totalPages];
            } else if (currentPage >= totalPages - 2) {
                pagesToShow = [1, '...', totalPages - 2, totalPages - 1, totalPages];
            } else {
                pagesToShow = [1, '...', currentPage - 1, currentPage, currentPage + 1, '...', totalPages];
            }
        }

        // Render các nút trang
        pagesToShow.forEach(page => {
            if (page === '...') {
                pageNumbers.innerHTML += `<span class="ellipsis">...</span>`;
            } else {
                pageNumbers.innerHTML += `
                <button class="page-btn ${page === currentPage ? 'active' : ''}"
                        onclick="goToPage(${page})">
                    ${page}
                </button>
            `;
            }
        });
    }

    function goToPage(page) {
        if (page < 1 || page > Math.ceil(submissionsData.length / ITEMS_PER_PAGE)) return;
        currentPage = page;
        updateDisplayWithAnimation();
    }

    // Thêm hiệu ứng chuyển trang
    function updateDisplayWithAnimation() {
        const submissionsList = document.getElementById('submissions-list');

        // Hiệu ứng fade out
        submissionsList.style.transition = 'all 0.3s ease';
        submissionsList.style.opacity = '0';
        submissionsList.style.transform = 'translateY(20px)';

        setTimeout(() => {
            // Cập nhật nội dung
            displaySubmissions(currentPage);
            updatePagination();

            // Hiệu ứng fade in
            setTimeout(() => {
                submissionsList.style.opacity = '1';
                submissionsList.style.transform = 'translateY(0)';
            }, 50);
        }, 300);
    }


    function updateDisplay() {
        displaySubmissions(currentPage);
        updatePagination();
    }

    // Khởi tạo hiển thị khi trang được tải
    document.addEventListener('DOMContentLoaded', () => {
        // Hiển thị ban đầu không cần animation
        displaySubmissions(currentPage);
        updatePagination();
    });

    // Code AI recommendations có thể giữ nguyên trong document.addEventListener
    document.addEventListener("DOMContentLoaded", function () {
        // Cập nhật userData với thêm thông tin cho stats
        const userData = {
            submissions: {
                months: /*[[${chartData.passedTestsPerMonth}]]*/0,
                total: /*[[${chartData.userExercises}]]*/0,
                accepted: /*[[${chartData.userPassedExercises}]]*/0
            },
            difficulty: {
                easy: /*[[${chartData.userEasyExercises}]]*/0,
                medium: /*[[${chartData.userMediumExercises}]]*/0,
                hard: /*[[${chartData.userHardExercises}]]*/0,
                totalEasy: /*[[${chartData.easyExercises}]]*/0,
                totalMedium: /*[[${chartData.mediumExercises}]]*/0,
                totalHard: /*[[${chartData.hardExercises}]]*/0,
                totalJava: /*[[${chartData.totalJava}]]*/0,
                totalC: /*[[${chartData.totalC}]]*/0,
                totalCsharp: /*[[${chartData.totalCsharp}]]*/0,
                totalCpp: /*[[${chartData.totalCpp}]]*/0,
                totalSql: /*[[${chartData.totalSql}]]*/0,
                userJava: /*[[${chartData.userJava}]]*/0,
                userC: /*[[${chartData.userC}]]*/0,
                userCsharp: /*[[${chartData.userCsharp}]]*/0,
                userCpp: /*[[${chartData.userCpp}]]*/0,
                userSql: /*[[${chartData.userSql}]]*/0
            },
            difficultyNoLanguage: {
                easyNoLanguage: /*[[${chartData.userEasyExercisesNoLanguage}]]*/0,
                mediumNoLanguage: /*[[${chartData.userMediumExercisesNoLanguage}]]*/0,
                hardNoLanguage: /*[[${chartData.userHardExercisesNoLanguage}]]*/0,
                totalEasyNoLanguage: /*[[${chartData.easyExercisesNoLanguage}]]*/0,
                totalMediumNoLanguage: /*[[${chartData.mediumExercisesNoLanguage}]]*/0,
                totalHardNoLanguage: /*[[${chartData.hardExercisesNoLanguage}]]*/0
            },
        };

        // Function to update stats
        function updateStats(userData) {
            // Calculate total solved problems
            const totalSubmittedSolved = userData.submissions.accepted;
            const totalSubmitted = userData.submissions.total;
            // Calculate total problems available
            const totalProblems = userData.difficultyNoLanguage.totalEasyNoLanguage +
                userData.difficultyNoLanguage.totalMediumNoLanguage +
                userData.difficultyNoLanguage.totalHardNoLanguage;
            const totalSolved = userData.difficultyNoLanguage.easyNoLanguage +
                userData.difficultyNoLanguage.mediumNoLanguage +
                userData.difficultyNoLanguage.hardNoLanguage;
            // Calculate acceptance rate
            const acceptanceRate = totalSubmitted > 0
                ? Math.round((totalSubmittedSolved / totalSubmitted) * 100)
                : 0;
            // Update UI
            document.querySelector('.stat-item:nth-child(1) .stat-number').textContent =
                `${totalSolved}/${totalProblems}`;
            document.querySelector('.stat-item:nth-child(2) .stat-number').textContent =
                totalSubmitted;
            document.querySelector('.stat-item:nth-child(3) .stat-number').textContent =
                `${acceptanceRate}%`;
        }

        // Call updateStats initially
        updateStats(userData);

        // Function for backend updates
        window.updateUserData = function (newUserData) {
            Object.assign(userData, newUserData);
            updateStats(userData);
            updateAchievements(userData);
        };

        const totalExercises = userData.difficultyNoLanguage.totalEasyNoLanguage+userData.difficultyNoLanguage.totalMediumNoLanguage+userData.difficultyNoLanguage.totalHardNoLanguage;
        const userCurrentExercises = userData.difficultyNoLanguage.easyNoLanguage+userData.difficultyNoLanguage.mediumNoLanguage+userData.difficultyNoLanguage.hardNoLanguage;

        // Define achievements
        const achievementTypes = {
            HARD_MASTER: {
                id: 'hard-master',
                title: 'Hard Master',
                description: 'Solved half of Hard Problems',
                icon: 'fa-crown',
                requirement: Math.round(userData.difficultyNoLanguage.totalHardNoLanguage / 2),
                checkProgress: (userData) => ({
                    current: userData.difficultyNoLanguage.hardNoLanguage,
                    total: Math.round(userData.difficultyNoLanguage.totalHardNoLanguage / 2),
                    isCompleted: userData.difficultyNoLanguage.hardNoLanguage >= Math.round(userData.difficultyNoLanguage.totalHardNoLanguage / 2)
                })
            },
            MEDIUM_EXPERT: {
                id: 'medium-expert',
                title: 'Medium Expert',
                description: 'Solved half of Medium Problems',
                icon: 'fa-star',
                requirement: Math.round(userData.difficultyNoLanguage.totalMediumNoLanguage / 2),
                checkProgress: (userData) => ({
                    current: userData.difficultyNoLanguage.mediumNoLanguage,
                    total: Math.round(userData.difficultyNoLanguage.totalMediumNoLanguage / 2),
                    isCompleted: userData.difficultyNoLanguage.mediumNoLanguage >= Math.round(userData.difficultyNoLanguage.totalMediumNoLanguage / 2)
                })
            },
            PROBLEM_SOLVER: {
                id: 'problem-solver',
                title: 'Problem Solver',
                description: 'Solved 50+ Problems',
                icon: 'fa-award',
                requirement: 50,
                checkProgress: (userData) => {
                    const totalSolved = userData.difficultyNoLanguage.easyNoLanguage +
                        userData.difficultyNoLanguage.mediumNoLanguage +
                        userData.difficultyNoLanguage.hardNoLanguage;                        return {
                        current: totalSolved,
                        total: 50,
                        isCompleted: totalSolved >= 50
                    };
                }
            },
            PERSISTENT: {
                id: 'persistent',
                title: 'Persistent',
                description: 'Solved a problem after 5+ attempts',
                icon: 'fa-dumbbell',
                requirement: 1,
                checkProgress: (userData) => ({
                    current: /*[[${chartData.exercisesWithMoreThanFiveAttempts}]]*/0,
                    total: 1,
                    isCompleted: /*[[${chartData.exercisesWithMoreThanFiveAttempts}]]*/0 >= 1
                })
            },
            EARLY_BIRD: {
                id: 'early-bird',
                title: 'Early Bird',
                description: 'Solved a problem before 6 AM',
                icon: 'fa-sun',
                requirement: 1,
                checkProgress: (userData) => ({
                    current: /*[[${chartData.exercisesSubmittedEarly}]]*/0,
                    total: 1,
                    isCompleted: /*[[${chartData.exercisesSubmittedEarly}]]*/0 >= 1
                })
            },
            NIGHT_OWL: {
                id: 'night-owl',
                title: 'Night Owl',
                description: 'Solved a problem after midnight',
                icon: 'fa-moon',
                requirement: 1,
                checkProgress: (userData) => ({
                    current: /*[[${chartData.exercisesSubmittedMidnight}]]*/0,
                    total: 1,
                    isCompleted: /*[[${chartData.exercisesSubmittedMidnight}]]*/0 >= 1
                })
            },
            PERFECT_SOLUTION: {
                id: 'perfect-solution',
                title: 'Perfect Solution',
                description: 'Got 100% on all test cases first try',
                icon: 'fa-check-circle',
                requirement: 1,
                checkProgress: (userData) => ({
                    current: /*[[${chartData.perfectScoreUserExercises}]]*/0,
                    total: 1,
                    isCompleted: /*[[${chartData.perfectScoreUserExercises}]]*/0 >= 1
                })
            },
            MASTER_CHEF: {
                id: 'masterchef',
                title: 'Master Chef',
                description: 'Done 100% exercises',
                icon: 'fa-solid fa-utensils',
                requirement: totalExercises,
                checkProgress: (userData) => ({
                    current: userCurrentExercises,
                    total: totalExercises,
                    isCompleted: Number(userCurrentExercises) === Number(totalExercises)
                })
            },
            MASTER_CHEF_INTERMEDIATE: {
                id: 'masterchef-intermediate',
                title: 'Intermediate Chef',
                description: 'Done 50% exercises',
                icon: 'fa-solid fa-spoon',
                requirement: Math.round(totalExercises / 2),
                checkProgress: (userData) => ({
                    current: userCurrentExercises,
                    total: Math.round(totalExercises / 2),
                    isCompleted: Number(userCurrentExercises) >= Math.round(Number(totalExercises) / 2)
                })
            },
            MASTER_CHEF_BEGINNER: {
                id: 'masterchef-beginner',
                title: 'Beginner Chef',
                description: 'Done 10% exercises',
                icon: 'fa-solid fa-egg',
                requirement: Math.round(totalExercises / 10),
                checkProgress: (userData) => ({
                    current: userCurrentExercises,
                    total: Math.round(totalExercises / 10),
                    isCompleted: Number(userCurrentExercises) >= Math.round(Number(totalExercises) / 10)
                })
            },
            JAVA_MASTER: {
                id: 'Java-Master',
                title: 'Java Master',
                description: 'Done 100% Java exercises and pass with >= 70 score',
                icon: 'devicon-java-plain',  // Switched to Devicon for consistency
                requirement: userData.difficulty.totalJava,
                checkProgress: (userData) => ({
                    current: userData.difficulty.userJava,
                    total: userData.difficulty.totalJava,
                    isCompleted: Number(userData.difficulty.userJava) === Number(userData.difficulty.totalJava)
                })
            },
            JAVA_INTERMEDIATE: {
                id: 'Java-Intermediate',
                title: 'Java Intermediate',
                description: 'Done 50% Java exercises and pass with >= 70 score',
                icon: 'fa-solid fa-mug-hot',
                requirement: Math.round(userData.difficulty.totalJava / 2),
                checkProgress: (userData) => ({
                    current: userData.difficulty.userJava,
                    total: Math.round(userData.difficulty.totalJava / 2),
                    isCompleted: Number(userData.difficulty.userJava) >= Math.round(Number(userData.difficulty.totalJava) / 2)
                })
            },
            JAVA_BEGINNER: {
                id: 'Java-Beginner',
                title: 'Java Beginner',
                description: 'Done 10% Java exercises and pass with >= 70 score',
                icon: 'fa-solid fa-mug-saucer',
                requirement: Math.round(userData.difficulty.totalJava / 10),
                checkProgress: (userData) => ({
                    current: userData.difficulty.userJava,
                    total: Math.round(userData.difficulty.totalJava / 10),
                    isCompleted: Number(userData.difficulty.userJava) >= Math.round(Number(userData.difficulty.totalJava) / 10)
                })
            },
            SQL_MASTER: {
                id: 'SQL-Master',
                title: 'SQL Master',
                description: 'Done 100% SQL exercises and pass with >= 70 score',
                icon: 'fa-solid fa-database',
                requirement: userData.difficulty.totalSql,
                checkProgress: (userData) => ({
                    current: userData.difficulty.userSql,
                    total: userData.difficulty.totalSql,
                    isCompleted: Number(userData.difficulty.userSql) === Number(userData.difficulty.totalSql)
                })
            },
            SQL_INTERMEDIATE: {
                id: 'SQL-Intermediate',
                title: 'SQL Intermediate',
                description: 'Done 50% SQL exercises and pass with >= 70 score',
                icon: 'fa-solid fa-table',
                requirement: Math.round(userData.difficulty.totalSql / 2),
                checkProgress: (userData) => ({
                    current: userData.difficulty.userSql,
                    total: Math.round(userData.difficulty.totalSql / 2),
                    isCompleted: Number(userData.difficulty.userSql) >= Math.round(Number(userData.difficulty.totalSql) / 2)
                })
            },
            SQL_BEGINNER: {
                id: 'SQL-Beginner',
                title: 'SQL Beginner',
                description: 'Done 10% SQL exercises and pass with >= 70 score',
                icon: 'fa-solid fa-table-cells',
                requirement: Math.round(userData.difficulty.totalSql / 10),
                checkProgress: (userData) => ({
                    current: userData.difficulty.userSql,
                    total: Math.round(userData.difficulty.totalSql / 10),
                    isCompleted: Number(userData.difficulty.userSql) >= Math.round(Number(userData.difficulty.totalSql) / 10)
                })
            },
            C_MASTER: {
                id: 'C-Master',
                title: 'C Master',
                description: 'Done 100% C exercises and pass with >= 70 score',
                icon: 'devicon-c-plain',
                requirement: userData.difficulty.totalC,
                checkProgress: (userData) => ({
                    current: userData.difficulty.userC,
                    total: userData.difficulty.totalC,
                    isCompleted: Number(userData.difficulty.userC) === Number(userData.difficulty.totalC)
                })
            },
            C_INTERMEDIATE: {
                id: 'C-Intermediate',
                title: 'C Intermediate',
                description: 'Done 50% C exercises and pass with >= 70 score',
                icon: 'devicon-c-line',
                requirement: Math.round(userData.difficulty.totalC / 2),
                checkProgress: (userData) => ({
                    current: userData.difficulty.userC,
                    total: Math.round(userData.difficulty.totalC / 2),
                    isCompleted: Number(userData.difficulty.userC) >= Math.round(Number(userData.difficulty.totalC) / 2)
                })
            },
            C_BEGINNER: {
                id: 'C-Beginner',
                title: 'C Beginner',
                description: 'Done 10% C exercises and pass with >= 70 score',
                icon: 'fa-solid fa-code',
                requirement: Math.round(userData.difficulty.totalC / 10),
                checkProgress: (userData) => ({
                    current: userData.difficulty.userC,
                    total: Math.round(userData.difficulty.totalC / 10),
                    isCompleted: Number(userData.difficulty.userC) >= Math.round(Number(userData.difficulty.totalC) / 10)
                })
            },
            CPP_MASTER: {
                id: 'Cpp-Master',
                title: 'C++ Master',
                description: 'Done 100% C++ exercises and pass with >= 70 score',
                icon: 'devicon-cplusplus-plain',
                requirement: userData.difficulty.totalCpp,
                checkProgress: (userData) => ({
                    current: userData.difficulty.userCpp,
                    total: userData.difficulty.totalCpp,
                    isCompleted: Number(userData.difficulty.userCpp) === Number(userData.difficulty.totalCpp)
                })
            },
            CPP_INTERMEDIATE: {
                id: 'Cpp-Intermediate',
                title: 'C++ Intermediate',
                description: 'Done 50% C++ exercises and pass with >= 70 score',
                icon: 'devicon-cplusplus-line',
                requirement: Math.round(userData.difficulty.totalCpp / 2),
                checkProgress: (userData) => ({
                    current: userData.difficulty.userCpp,
                    total: Math.round(userData.difficulty.totalCpp / 2),
                    isCompleted: Number(userData.difficulty.userCpp) >= Math.round(Number(userData.difficulty.totalCpp) / 2)
                })
            },
            CPP_BEGINNER: {
                id: 'Cpp-Beginner',
                title: 'C++ Beginner',
                description: 'Done 10% C++ exercises and pass with >= 70 score',
                icon: 'fa-solid fa-plus',
                requirement: Math.round(userData.difficulty.totalCpp / 10),
                checkProgress: (userData) => ({
                    current: userData.difficulty.userCpp,
                    total: Math.round(userData.difficulty.totalCpp / 10),
                    isCompleted: Number(userData.difficulty.userCpp) >= Math.round(Number(userData.difficulty.totalCpp) / 10)
                })
            },
            CSHARP_MASTER: {
                id: 'CSharp-Master',
                title: 'C# Master',
                description: 'Done 100% C# exercises and pass with >= 70 score',
                icon: 'devicon-csharp-plain',
                requirement: userData.difficulty.totalCsharp,
                checkProgress: (userData) => ({
                    current: userData.difficulty.userCsharp,
                    total: userData.difficulty.totalCsharp,
                    isCompleted: Number(userData.difficulty.userCsharp) === Number(userData.difficulty.totalCsharp)
                })
            },
            CSHARP_INTERMEDIATE: {
                id: 'CSharp-Intermediate',
                title: 'C# Intermediate',
                description: 'Done 50% C# exercises and pass with >= 70 score',
                icon: 'devicon-csharp-line',
                requirement: Math.round(userData.difficulty.totalCsharp / 2),
                checkProgress: (userData) => ({
                    current: userData.difficulty.userCsharp,
                    total: Math.round(userData.difficulty.totalCsharp / 2),
                    isCompleted: Number(userData.difficulty.userCsharp) >= Math.round(Number(userData.difficulty.totalCsharp) / 2)  // Fixed to >=
                })
            },
            CSHARP_BEGINNER: {
                id: 'CSharp-Beginner',
                title: 'C# Beginner',
                description: 'Done 10% C# exercises and pass with >= 70 score',
                icon: 'fa-solid fa-hashtag',
                requirement: Math.round(userData.difficulty.totalCsharp / 10),
                checkProgress: (userData) => ({
                    current: userData.difficulty.userCsharp,
                    total: Math.round(userData.difficulty.totalCsharp / 10),
                    isCompleted: Number(userData.difficulty.userCsharp) >= Math.round(Number(userData.difficulty.totalCsharp) / 10)  // Fixed to >=
                })
            },
            PERFECTIONIST: {
                id: 'perfectionist',
                title: 'Perfectionist',
                description: 'Achieved an acceptance rate above 95%.',
                icon: 'fa-medal',
                requirement: 90,
                checkProgress: (userData) => ({
                    current: Math.round((userData.submissions.accepted / userData.submissions.total) * 100) || 0,
                    total: 95,
                    isCompleted: Math.round((userData.submissions.accepted / userData.submissions.total) * 100) >= 90
                })
            },
            MARATHON_CODER: {
                id: 'marathon-coder',
                title: 'Marathon Coder',
                description: 'Submitted 50 problems in one month in this year.',
                icon: 'fa-running',
                requirement: 50,
                checkProgress: (userData) => ({
                    current:  Math.max(...Object.values(userData.submissions.months)),
                    total: 50,
                    isCompleted: Math.max(...Object.values(userData.submissions.months)) >= 50
                })
            },
            BALANCED_CODER: {
                id: 'balanced-coder',
                title: 'The Balanced Coder',
                description: 'Solved at least 5 problems at each difficulty level.',
                icon: 'fa-balance-scale',
                requirement: 5,
                checkProgress: (userData) => ({
                    current: Math.min(
                        userData.difficultyNoLanguage.easyNoLanguage,
                        userData.difficultyNoLanguage.mediumNoLanguage,
                        userData.difficultyNoLanguage.hardNoLanguage
                    ),
                    total: 5,
                    isCompleted: Math.min(
                        userData.difficultyNoLanguage.easyNoLanguage,
                        userData.difficultyNoLanguage.mediumNoLanguage,
                        userData.difficultyNoLanguage.hardNoLanguage
                    ) >= 5
                })
            },
        };

        // Hàm tạo HTML cho achievement
        function createAchievementHTML(achievement, progress) {
            return `
                    <div class="achievement-item"
                         data-achievement-id="${achievement.id}"
                         data-bs-toggle="tooltip"
                         data-bs-placement="top"
                         data-bs-custom-class="achievement-tooltip"
                         title="${achievement.description}">
                        <div class="achievement-icon ${progress.isCompleted ? 'unlocked' : ''}">
                            <i style="font-size: 40px" class="fa ${achievement.icon}"></i>
                        </div>
                        <div class="achievement-info">
                            <div class="achievement-name">${achievement.title}</div>
                        <div class="achievement-progress">
                    ${progress.isCompleted ? '<span class="completed-text">Completed</span>' : `${progress.current}/${progress.total}`}
                        </div>
                 </div>
                    </div>
                `;
        }

        // Hàm cập nhật achievements
        function updateAchievements(userData) {
            const achievementsContainer = document.querySelector('.achievements-grid');
            achievementsContainer.innerHTML = '';

            let completedCount = 0;
            const totalAchievements = Object.keys(achievementTypes).length;

            // Thêm tất cả achievements vào container và đếm số lượng hoàn thành
            Object.values(achievementTypes).forEach(achievement => {
                const progress = achievement.checkProgress(userData);
                if (progress.isCompleted) {
                    completedCount++;
                }
                const achievementHTML = createAchievementHTML(achievement, progress);
                achievementsContainer.insertAdjacentHTML('beforeend', achievementHTML);
            });

            // Cập nhật số đếm achievements
            document.getElementById('completed-achievements').textContent = completedCount;
            document.getElementById('total-achievements').textContent = totalAchievements;

            // Khởi tạo tooltips
            const tooltips = document.querySelectorAll('[data-bs-toggle="tooltip"]');
            tooltips.forEach(tooltip => new bootstrap.Tooltip(tooltip, {
                trigger: 'hover',
                animation: true,
                delay: { show: 100, hide: 100 }
            }));
        }

        // Khởi tạo charts khi scroll đến gần vị trí hiển thị
        const observerOptions = {
            root: null,
            rootMargin: '50px',
            threshold: 0.1
        };

        const chartsObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    requestAnimationFrame(() => {
                        if (entry.target.id === "progressChart") {
                            initProgressChart(userData);
                        } else if (entry.target.id === "difficultyChart") {
                            initDifficultyChart(userData);
                        }
                    });
                    chartsObserver.unobserve(entry.target);
                }
            });
        }, observerOptions);

        // Theo dõi các chart elements
        document.querySelectorAll('#progressChart, #difficultyChart').forEach(chart => {
            chartsObserver.observe(chart);
        });

        function initProgressChart(userData) {
            const submissionCtx = document.getElementById("progressChart").getContext("2d");
            new Chart(submissionCtx, {
                type: 'bar',
                data: {
                    labels: Object.keys(userData.submissions.months),
                    datasets: [{
                        label: 'Submissions',
                        data: Object.values(userData.submissions.months),
                        backgroundColor: '#2cbb5d',
                        borderRadius: 4,
                        barThickness: 8,
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    animation: {
                        duration: 800,
                        easing: 'easeOutQuart',
                        delay: (context) => context.dataIndex * 50
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgb(40, 40, 40)',
                            titleColor: 'rgb(255, 255, 255)',
                            bodyColor: 'rgb(255, 255, 255)',
                            padding: 12,
                            displayColors: false
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                display: false,
                                drawBorder: false
                            },
                            ticks: {
                                color: 'rgb(156, 156, 156)'
                            }
                        },
                        y: {
                            grid: {
                                color: 'rgb(48, 48, 48)',
                                drawBorder: false
                            },
                            ticks: {
                                color: 'rgb(156, 156, 156)',
                                stepSize: 1
                            },
                            suggestedMax: Math.max(...Object.values(userData.submissions.months)) * 1.05
                        }
                    }
                }
            });
        }

        function initDifficultyChart() {
            const difficultyCtx = document.getElementById("difficultyChart").getContext("2d");

            let stats = {
                userEasy: /*[[${chartData.userEasyExercises}]]*/0,
                userMedium: /*[[${chartData.userMediumExercises}]]*/0,
                userHard: /*[[${chartData.userHardExercises}]]*/0,
                totalEasy: /*[[${chartData.easyExercises}]]*/1,  // Avoid division by zero
                totalMedium: /*[[${chartData.mediumExercises}]]*/1,
                totalHard: /*[[${chartData.hardExercises}]]*/1
            };

            new Chart(difficultyCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Easy', 'Medium', 'Hard'],
                    datasets: [{
                        data: [stats.userEasy, stats.userMedium, stats.userHard],
                        backgroundColor: ['#2cbb5d', '#ffc01e', '#ef4743'],
                        borderWidth: 0,
                        borderRadius: 4,
                        spacing: 3,
                        cutout: '75%',
                        radius: '90%'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    animation: {
                        duration: 1000,
                        easing: 'easeOutCirc',
                        animateRotate: true,
                        animateScale: true
                    },
                    plugins: {
                        legend: {
                            position: 'right',
                            labels: {
                                color: '#FFFFFF',
                                font: { size: 15 },
                                generateLabels: function (chart) {
                                    const data = chart.data;
                                    return data.labels.map((label, i) => {
                                        let key = `user${label}`; // 'userEasy', 'userMedium', 'userHard'
                                        let totalKey = `total${label}`; // 'userTotalEasy', 'totalMedium', 'totalHard'
                                        return {
                                            text: `${label} ${stats[key]}/${stats[totalKey]}`,
                                            fillStyle: data.datasets[0].backgroundColor[i],
                                            hidden: false,
                                            index: i,
                                            fontColor: "#FFFFFF" // Ensures white text
                                        };
                                    });
                                }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function (context) {
                                    let label = context.label;
                                    let value = context.raw;
                                    let total = stats.userHard+stats.userEasy+stats.userMedium;
                                    let percentage = Math.round((value / total) * 100);
                                    return `${label}: ${value}/${total} (${percentage}%)`;
                                }
                            }
                        }
                    }
                }
            });
        }


        // Gọi hàm để khởi tạo biểu đồ khi DOM đã tải
        document.addEventListener("DOMContentLoaded", function () {
            initDifficultyChart(userData);
        });


        // Xử lý chỉnh sửa profile
        document.getElementById("saveProfile").addEventListener("click", function () {
            document.getElementById("username").textContent = document.getElementById("editUsername").value;
            document.getElementById("email").textContent = document.getElementById("editEmail").value;
            document.getElementById("editProfileModal").querySelector(".btn-close").click();
        });

        // Cập nhật achievements ban đầu
        updateAchievements(userData);

        // Thêm vào phần JavaScript hiện có
        async function generateAIRecommendations(userData) {
            const recommendationsContainer = document.getElementById('aiRecommendations');
            const selectedLanguage = document.getElementById('promptLanguage').value;

            // Hiển thị loading spinner với text tương ứng ngôn ngữ
            const loadingText = selectedLanguage === 'vi' ? 'Đang phân tích dữ liệu...' : 'Analyzing data...';
            recommendationsContainer.innerHTML = `
                    <div class="loading-spinner">
                        <i class="fas fa-spinner fa-spin"></i> ${loadingText}
                    </div>
                `;

            try {
                const API_KEY = 'AIzaSyBVvP7mpC7CrpDpCEUgc7z7nNAkedTkc5Y';
                const API_ENDPOINT = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${API_KEY}`;

                // Tạo prompt dựa trên ngôn ngữ đã chọn
                const promptText = selectedLanguage === 'vi' ?
                    `Phân tích dữ liệu lập trình và đưa ra các khuyến nghị học tập ngắn gọn, có mục tiêu.

                        THỐNG KÊ TỔNG QUAN:
                        - Tổng số bài đã giải: ${userData.difficulty.easy + userData.difficulty.medium + userData.difficulty.hard}
                        - Tổng số lần nộp bài: ${userData.submissions.total}
                        - Tỷ lệ chấp nhận: ${(userData.submissions.accepted / userData.submissions.total * 100).toFixed(1)}%

                        Dựa trên các số liệu thống kê được cung cấp, hãy đưa ra các khuyến nghị ngắn gọn theo định dạng JSON với cấu trúc sau:

                        {
                            "recommendations": [
                                {
                                    "title": "Tiêu đề khuyến nghị ngắn gọn và rõ ràng",
                                    "difficulty": "Dễ/Trung bình/Khó",
                                    "description": "Thới thiệu thêm về những cái cần học đối với ngôn ngữ đó (tối đa 3 câu)",
                                    "reason": "Lý do cụ thể dựa trên dữ liệu đã cung cấp (tối đa 2 câu)"
                                }
                            ]
                        }

                        Hướng dẫn quan trọng:
                        - Nêu rõ điểm mạnh và điểm yếu của từng ngôn ngữ CHỈ dựa trên số liệu thống kê.
                        - Cung cấp lộ trình học tập rõ ràng và ngắn gọn cho từng ngôn ngữ.
                        - Đề xuất các bài toán tiếp theo phù hợp với trình độ đã thể hiện của người dùng.
                        - Đề xuất các chủ đề hoặc khái niệm cụ thể cần học, liên quan trực tiếp đến điểm yếu đã thể hiện.

                        Tránh đưa ra lời khuyên chung chung hoặc mơ hồ.` :
                    `Analyze the provided programming data and generate concise, targeted learning recommendations.

                        OVERALL STATISTICS:
                        - Total Problems Solved: ${userData.difficulty.easy + userData.difficulty.medium + userData.difficulty.hard}
                        - Total Submissions: ${userData.submissions.total}
                        - Acceptance Rate: ${(userData.submissions.accepted / userData.submissions.total * 100).toFixed(1)}%


                        Based strictly on the provided statistics, please provide concise recommendations in JSON format with the following clear structure:

                        {
                            "recommendations": [
                                {
                                    "title": "Brief and clear recommendation title",
                                    "difficulty": "Easy/Medium/Hard",
                                    "description": "Introduce more about what you need to learn for that language (maximum 3 sentences)",
                                    "reason": "Direct and specific reasoning based solely on the provided data (max 2 sentences)"
                                }
                            ]
                        }

                        Important guidelines:
                        - Clearly state strengths and weaknesses of each language based ONLY on provided statistics.
                        - Provide a clear, concise learning path for each language.
                        - Recommend next problems to tackle, directly matching the user's demonstrated proficiency.
                        - Suggest specific topics or concepts to learn, directly relevant to the user's demonstrated weaknesses.

                        Avoid general or vague advice.`;

                const prompt = {
                    contents: [{
                        parts: [{
                            text: promptText
                        }]
                    }]
                };

                console.log('Calling Gemini API...');

                const response = await fetch(API_ENDPOINT, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(prompt)
                });

                if (!response.ok) {
                    throw new Error(`API error: ${response.status}`);
                }

                const data = await response.json();
                console.log('API response:', data);

                if (!data.candidates?.[0]?.content?.parts?.[0]?.text) {
                    throw new Error('Invalid API response format');
                }

                const responseText = data.candidates[0].content.parts[0].text;
                console.log('API text response:', responseText);

                // Tìm JSON trong phản hồi
                const jsonMatch = responseText.match(/\{[\s\S]*\}/);
                if (!jsonMatch) {
                    throw new Error('Không tìm thấy JSON trong phản hồi');
                }

                const recommendations = JSON.parse(jsonMatch[0]).recommendations;

                if (!Array.isArray(recommendations) || recommendations.length === 0) {
                    throw new Error('Không có khuyến nghị hợp lệ');
                }

                // Hiển thị recommendations
                recommendationsContainer.innerHTML = '';
                recommendations.forEach(rec => {
                    recommendationsContainer.innerHTML += `
                            <div class="recommendation-item ${rec.difficulty.toLowerCase()}">
                                <div class="recommendation-title">
                                    ${rec.title}
                                    <span class="recommendation-tag ${rec.difficulty.toLowerCase()}">${rec.difficulty}</span>
                                </div>
                                <div class="recommendation-description">${rec.description}</div>
                                <div class="recommendation-reason">${rec.reason}</div>
                            </div>
                        `;
                });

            } catch (error) {
                console.error('Error:', error);
                const errorMessage = selectedLanguage === 'vi' ?
                    'Đã xảy ra lỗi' :
                    'An error occurred';
                const retryText = selectedLanguage === 'vi' ?
                    'Thử lại' :
                    'Retry';

                recommendationsContainer.innerHTML = `
                        <div class="error-message" style="color: #ef4743; padding: 15px; text-align: center;">
                            <i class="fas fa-exclamation-circle"></i>
                            ${errorMessage}: ${error.message}
                            <br><br>
                            <button onclick="generateAIRecommendations(userData)" class="btn btn-outline-danger btn-sm">
                                <i class="fas fa-sync-alt"></i> ${retryText}
                            </button>
                        </div>
                    `;
            }
        }

        // Thêm event listener cho nút refresh
        document.getElementById('refreshRecommendations').addEventListener('click', function () {
            generateAIRecommendations(userData);
        });
    });
    /*]]>*/
</script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

</body>

</html>